# Copilot Instructions for Untitled UI Library

## Project Overview

**What is this?** A TypeScript React component library inspired by Project SEKAI (Hatsune Miku rhythm game), providing 40+ themed UI components with dynamic color system and light/dark mode support. This is a production-ready library distributed via GitHub releases.

**Tech Stack:**
- React 19 + TypeScript (strict mode enabled)
- SCSS + CSS Modules (scoped component styling)
- Rollup (dual ESM/CJS bundling with type declarations)
- Storybook (component documentation and development)
- Jest + React Testing Library
- Python 3.12+ (for code generation scripts)

**Key Characteristics:**
- ~75 TypeScript/TSX files in `src/`
- 22 component categories (button, card, dialog, dropdown, etc.)
- 40+ character/unit color constants from Project SEKAI
- Next.js App Router compatible ('use client' directives auto-injected)
- ~1.6MB dist output (ESM + CJS + types + CSS)

---

## Documentation Index

Detailed documentation has been split into separate files for easier maintenance:

| Document | Description |
|----------|-------------|
| [Build & CI/CD](../docs/build-and-ci.md) | Build commands, CI/CD pipeline, common tasks & workflows |
| [Project Architecture](../docs/project-architecture.md) | Source code structure, configuration files, path aliases |
| [Component Patterns](../docs/component-patterns.md) | Component architecture, advanced patterns, theme provider |
| [Styling System](../docs/styling-system.md) | Global styles, color system, utilities, import paths |
| [Code Conventions](../docs/code-conventions.md) | Critical rules, import order, ESLint, naming conventions, best practices |
| [Code Review](../docs/code-review.md) | Review checklist, guidelines (Japanese) |
| [Troubleshooting](../docs/troubleshooting.md) | Common issues and solutions |

---

## Quick Reference

### Essential Commands
```bash
npm run dev              # Start Storybook (localhost:6006)
npm run build            # Full build (clean → index → rollup → tsc)
npm run lint             # ESLint with auto-fix
npm run prettier         # Format code
npm run plop             # Generate new component
npm run generate-index   # Regenerate index files
npm test                 # Run tests
npm run build-storybook  # Build Storybook static site
```

### Critical Rules Summary

**NEVER:**
- Modify dist/ manually
- Edit src/**/index.ts manually (auto-generated)
- Add 'use client' directive manually
- Skip `npm run generate-index` after file changes
- Commit with lint warnings
- Use `any` type

**ALWAYS:**
- Run `npm install` first
- Run `npm run generate-index` after file changes
- Run `npm run lint` before committing
- Run `npm run build` before pushing
- Use Plop for new components
- Use `useOptionalSekai` for themed components

---

## Notes for AI Assistants

### Context Awareness

- **Project theme:** Project SEKAI (Hatsune Miku) fan project
- **Language:** Code/docs in English, PR template/README in Japanese
- **Target users:** React developers, Next.js apps
- **Maturity:** Production-ready library with established patterns

### When Making Changes

1. **Read files first** - NEVER propose changes to unread code
2. **Follow patterns** - Match existing component structure exactly
3. **Run tools** - Use Plop for new components, generate-index after file changes
4. **Test thoroughly** - Storybook, accessibility (axe DevTools), build
5. **Update exports** - ALWAYS run `npm run generate-index` after adding/removing files

### Common Mistakes to Avoid

- ❌ Creating new patterns instead of following existing ones
- ❌ Over-engineering simple components
- ❌ Skipping the build process before committing
- ❌ Manually editing index files (auto-generated by Python script)
- ❌ Adding files without running `npm run generate-index`
- ❌ Forgetting accessibility attributes (required for all components)
- ❌ Ignoring ESLint warnings (max-warnings=0 enforced)
- ❌ Adding `'use client'` directive manually (Rollup handles it)

### When Uncertain

1. **Check Storybook** - See how existing components work (http://localhost:6006)
2. **Read similar components** - Follow established patterns in codebase
3. **Check global styles** - Utility classes might already exist
4. **Review recent commits** - Understand project conventions (`git log`)
5. **Refer to CLAUDE.md** - Comprehensive guide with detailed examples

### Critical Reminders

- This is a **production-ready library** with strong conventions
- **Consistency** with existing code is more valuable than innovation
- Follow established patterns, use provided tools, maintain quality standards
- When in doubt, **read existing code** and **match its style**

---

## Trust These Instructions

These instructions have been validated by:
1. Running full install from scratch
2. Testing all build commands with timing measurements
3. Verifying CI workflow steps
4. Testing clean builds after removing dist/
5. Validating all script paths and configurations

**If you encounter information not covered here or find errors, search the codebase to verify. Otherwise, trust and follow these instructions exactly.**

**For comprehensive details, see [CLAUDE.md](../CLAUDE.md)**
